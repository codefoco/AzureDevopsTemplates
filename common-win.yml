steps:
- script: 'choco install gitversion.portable --version=6.5.0'
  displayName: 'Install GitVersion'
  
- script: 'choco install nunit-console-runner --version=3.20.2'
  displayName: 'Install  nunit-console-runner'

# - script: '"C:\Android\android-sdk\cmdline-tools\latest\bin\sdkmanager" "platforms;android-33"'
#   displayName: 'Install Android platforms 33' 

# - script: '"C:\Android\android-sdk\cmdline-tools\latest\bin\sdkmanager" "platforms;android-34"'
#   displayName: 'Install Android platforms 34' 

- script: '"C:\Android\android-sdk\cmdline-tools\latest\bin\sdkmanager" "platforms;android-35"'
  displayName: 'Install Android platforms 35' 

- script: '"C:\Android\android-sdk\cmdline-tools\latest\bin\sdkmanager" "platforms;android-36"'
  displayName: 'Install Android platforms 36' 
  
- script: 'dotnet workload install android maui'
  displayName: 'Install .NET Android'
  
- task: JavaToolInstaller@0
  displayName: install JDK 17
  inputs:
    versionSpec: '17'
    jdkArchitectureOption: 'x64'
    jdkSourceOption: 'PreInstalled'

# Install Xamarin.Android
- task: CmdLine@2
  displayName: 'Provisioning Xamarin.Android'
  retryCountOnTaskFailure: 2
  inputs:
    script: 'curl -OL https://github.com/codefoco/AzureDevopsTemplates/releases/download/v1.0/Xamarin.Android.Sdk-13.2.2.0.vsix'

- script: |
    echo "Installing VSIX extension..."
    "C:\Program Files\Microsoft Visual Studio\2022\Enterprise\Common7\IDE\VSIXInstaller.exe" /quiet ".\Xamarin.Android.Sdk-13.2.2.0.vsix"
  displayName: 'Install VSIX extension'
  
# - task: CmdLine@2
#   displayName: 'Setup NDK path (due bug on NDK)'
#   inputs:
#     script: 'mklink /D Android "C:\Program Files (x86)\Android"'
#     workingDirectory: 'C:\'

# - powershell: |
#     # Define download URL for Windows 10 SDK 19041
#     $sdkUrl = "https://download.microsoft.com/download/1/4/3/143F3C4C-6C2E-4E7F-9D6B-5F3A3C1C6C7F/winsdksetup.exe"
#     $sdkInstaller = "$(Agent.TempDirectory)\winsdksetup.exe"

#     Write-Host "Downloading Windows 10 SDK installer..."
#     Invoke-WebRequest -Uri $sdkUrl -OutFile $sdkInstaller

#     Write-Host "Installing Windows 10 SDK silently..."
#     Start-Process -FilePath $sdkInstaller -ArgumentList "/quiet /norestart" -Wait -NoNewWindow

#     Write-Host "Windows 10 SDK installation completed."
#   displayName: "Download and Install Windows 10 SDK (10.0.19041)"
